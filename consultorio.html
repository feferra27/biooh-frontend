<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>BiOOH ‚Ä¢ Consult√≥rio ‚Äî Visualizador 3D</title>
  <link rel="stylesheet" href="assets/styles.css"/>
  <style>
    /* Estilos espec√≠ficos do consult√≥rio */
    .consultorio-container {
      display: flex;
      min-height: 100vh;
      background: var(--bg);
    }

    .sidebar {
      width: 320px;
      border-right: 1px solid var(--line);
      background: #FAFBFD;
      padding: 14px;
      overflow-y: auto;
      height: 100vh;
      position: sticky;
      top: 0;
    }

    .sidebar h3 {
      font-size: 14px;
      color: #1F3A8A;
      letter-spacing: 0.6px;
      text-transform: uppercase;
      margin: 16px 0 10px;
    }

    .model-card {
      border: 1px solid var(--line);
      border-radius: 12px;
      padding: 12px;
      background: #fff;
      cursor: pointer;
      transition: all 0.2s;
      margin-bottom: 10px;
    }

    .model-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(31, 99, 179, 0.08);
    }

    .model-card.active {
      outline: 2px solid rgba(31, 111, 235, 0.4);
      background: #F3F8FF;
    }

    .model-card strong {
      display: block;
      margin-bottom: 4px;
      color: var(--ink);
    }

    .model-card .desc {
      font-size: 13px;
      color: var(--mut);
    }

    .viewer-container {
      flex: 1;
      position: relative;
      display: flex;
      flex-direction: column;
    }

    .viewer-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 16px;
      border-bottom: 1px solid var(--line);
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(6px);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .back-btn {
      background: none;
      border: 1px solid var(--line);
      padding: 8px 14px;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 600;
      color: var(--ink);
      transition: all 0.2s;
    }

    .back-btn:hover {
      background: var(--calm);
      border-color: var(--brand);
    }

    .viewer-main {
      flex: 1;
      position: relative;
      background: #f9fafb;
    }

    #biodigital-iframe {
      width: 100%;
      height: 100%;
      border: 0;
      display: none;
    }

    .loading-overlay {
      position: absolute;
      inset: 0;
      display: grid;
      place-content: center;
      gap: 12px;
      background: rgba(255, 255, 255, 0.95);
      z-index: 50;
    }

    .loading-overlay.hidden {
      display: none;
    }

    .spinner {
      width: 48px;
      height: 48px;
      border: 3px solid #E5EAF0;
      border-top-color: #1F6FEB;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .loading-text {
      text-align: center;
      color: var(--mut);
      font-weight: 600;
    }

    .controls-panel {
      position: absolute;
      right: 16px;
      top: 16px;
      display: flex;
      flex-direction: column;
      gap: 8px;
      z-index: 10;
    }

    .ctrl-btn {
      background: rgba(255, 255, 255, 0.95);
      border: 1px solid var(--line);
      padding: 10px 14px;
      border-radius: 10px;
      cursor: pointer;
      font-size: 13px;
      font-weight: 600;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      transition: all 0.2s;
      white-space: nowrap;
    }

    .ctrl-btn:hover {
      background: #fff;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
    }

    .info-panel {
      border-top: 1px solid var(--line);
      background: #fff;
      padding: 14px 16px;
      color: var(--mut);
      line-height: 1.6;
      max-height: 120px;
      overflow-y: auto;
    }

    .info-panel.hidden {
      display: none;
    }

    .search-box {
      margin-bottom: 12px;
    }

    .search-input {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid var(--line);
      border-radius: 10px;
      font-size: 14px;
      background: #fff;
    }

    .search-input:focus {
      outline: none;
      border-color: var(--brand);
      box-shadow: 0 0 0 3px rgba(31, 111, 235, 0.1);
    }

    .category {
      margin-bottom: 20px;
    }

    @media (max-width: 768px) {
      .consultorio-container {
        flex-direction: column;
      }

      .sidebar {
        width: 100%;
        height: auto;
        position: relative;
        border-right: 0;
        border-bottom: 1px solid var(--line);
      }

      .controls-panel {
        flex-direction: row;
        right: auto;
        left: 16px;
        right: 16px;
        bottom: 16px;
        top: auto;
      }
    }
  </style>
</head>
<body>
  <div class="consultorio-container">
    <!-- Sidebar com lista de modelos -->
    <aside class="sidebar">
      <div class="brand" style="margin-bottom: 20px;">
        <div class="mark"></div>
        <div class="brandtxt" style="font-size: 18px; font-weight: 900; color: #1F3A8A;">Consult√≥rio</div>
      </div>

      <div class="search-box">
        <input 
          type="text" 
          id="searchInput" 
          class="search-input" 
          placeholder="Buscar modelos..."
          oninput="filterModels()"
        />
      </div>

      <div id="modelsContainer">
        <!-- Categoria: Diabetes e Metabolismo -->
        <div class="category">
          <h3>ü©∏ Diabetes & Metabolismo</h3>
          <div class="model-card active" onclick="loadModel('production/maleAdult/diabetes_mellitus_type_2', this)" data-keywords="diabetes tipo2 insulina glicose">
            <strong>Diabetes Tipo 2</strong>
            <div class="desc">Resist√™ncia √† insulina e metabolismo</div>
          </div>
          <div class="model-card" onclick="loadModel('production/maleAdult/pancreas', this)" data-keywords="pancreas insulina hormonio">
            <strong>P√¢ncreas</strong>
            <div class="desc">√ìrg√£o produtor de insulina</div>
          </div>
        </div>

        <!-- Categoria: Sistema Cardiovascular -->
        <div class="category">
          <h3>‚ù§Ô∏è Cardiovascular</h3>
          <div class="model-card" onclick="loadModel('cardiovascular_system', this)" data-keywords="coracao circulacao sangue">
            <strong>Sistema Cardiovascular</strong>
            <div class="desc">Cora√ß√£o e circula√ß√£o sangu√≠nea</div>
          </div>
          <div class="model-card" onclick="loadModel('production/maleAdult/heart', this)" data-keywords="coracao batimento cardiaco">
            <strong>Cora√ß√£o</strong>
            <div class="desc">Anatomia card√≠aca detalhada</div>
          </div>
          <div class="model-card" onclick="loadModel('production/maleAdult/hypertension', this)" data-keywords="hipertensao pressao arterial">
            <strong>Hipertens√£o</strong>
            <div class="desc">Press√£o arterial elevada</div>
          </div>
        </div>

        <!-- Categoria: Sistema Respirat√≥rio -->
        <div class="category">
          <h3>ü´Å Respirat√≥rio</h3>
          <div class="model-card" onclick="loadModel('respiratory_system', this)" data-keywords="pulmao respiracao ar">
            <strong>Sistema Respirat√≥rio</strong>
            <div class="desc">Pulm√µes e vias a√©reas</div>
          </div>
          <div class="model-card" onclick="loadModel('production/maleAdult/asthma', this)" data-keywords="asma bronquite">
            <strong>Asma</strong>
            <div class="desc">Inflama√ß√£o das vias a√©reas</div>
          </div>
        </div>

        <!-- Categoria: Sistema Digestivo -->
        <div class="category">
          <h3>üç¥ Digestivo</h3>
          <div class="model-card" onclick="loadModel('digestive_system', this)" data-keywords="estomago intestino digestao">
            <strong>Sistema Digestivo</strong>
            <div class="desc">√ìrg√£os da digest√£o</div>
          </div>
          <div class="model-card" onclick="loadModel('production/maleAdult/liver', this)" data-keywords="figado hepatico">
            <strong>F√≠gado</strong>
            <div class="desc">Fun√ß√£o hep√°tica</div>
          </div>
        </div>

        <!-- Categoria: Sistema Esquel√©tico -->
        <div class="category">
          <h3>ü¶¥ Esquel√©tico</h3>
          <div class="model-card" onclick="loadModel('skeletal_system', this)" data-keywords="ossos esqueleto">
            <strong>Sistema Esquel√©tico</strong>
            <div class="desc">Estrutura √≥ssea completa</div>
          </div>
          <div class="model-card" onclick="loadModel('production/maleAdult/osteoarthritis', this)" data-keywords="artrite articulacao">
            <strong>Osteoartrite</strong>
            <div class="desc">Desgaste articular</div>
          </div>
        </div>

        <!-- Categoria: Sistema Nervoso -->
        <div class="category">
          <h3>üß† Nervoso</h3>
          <div class="model-card" onclick="loadModel('nervous_system', this)" data-keywords="cerebro nervos">
            <strong>Sistema Nervoso</strong>
            <div class="desc">C√©rebro e nervos</div>
          </div>
          <div class="model-card" onclick="loadModel('production/maleAdult/brain', this)" data-keywords="cerebro cortex">
            <strong>C√©rebro</strong>
            <div class="desc">Anatomia cerebral</div>
          </div>
        </div>
      </div>
    </aside>

    <!-- Viewer principal -->
    <div class="viewer-container">
      <div class="viewer-header">
        <div style="display: flex; align-items: center; gap: 12px;">
          <button class="back-btn" onclick="goBack()">‚Üê Voltar</button>
          <div style="color: var(--mut); font-weight: 600;" id="currentModelName">Diabetes Tipo 2</div>
        </div>
        <div style="color: var(--mut); font-size: 14px;">
          <span id="viewerStatus">üü¢ Ativo</span>
        </div>
      </div>

      <div class="viewer-main">
        <div class="loading-overlay" id="loadingOverlay">
          <div class="spinner"></div>
          <div class="loading-text">Carregando modelo 3D...</div>
        </div>

        <iframe 
          id="biodigital-iframe" 
          title="BioDigital Human Viewer"
          allow="fullscreen"
        ></iframe>

        <div class="controls-panel">
          <button class="ctrl-btn" onclick="reloadModel()" title="Recarregar modelo">
            üîÑ Recarregar
          </button>
          <button class="ctrl-btn" onclick="toggleFullscreen()" title="Tela cheia">
            ‚õ∂ Tela Cheia
          </button>
          <button class="ctrl-btn" onclick="toggleInfo()" title="Informa√ß√µes">
            ‚ÑπÔ∏è Informa√ß√µes
          </button>
          <button class="ctrl-btn" onclick="resetCamera()" title="Resetar c√¢mera">
            üì∑ Resetar
          </button>
        </div>
      </div>

      <div class="info-panel" id="infoPanel">
        <div id="modelInfo">
          ü©∏ <strong>Diabetes Tipo 2:</strong> Condi√ß√£o cr√¥nica que afeta a forma como o corpo processa glicose. 
          A resist√™ncia √† insulina e a diminui√ß√£o da produ√ß√£o pancre√°tica levam a n√≠veis elevados de a√ß√∫car no sangue. 
          O controle glic√™mico, alimenta√ß√£o saud√°vel e atividade f√≠sica s√£o fundamentais para o tratamento.
        </div>
      </div>
    </div>
  </div>

  <script>
    // Configura√ß√£o e estado
    let currentModelId = 'production/maleAdult/diabetes_mellitus_type_2';
    let currentModelElement = null;

    // Informa√ß√µes dos modelos
    const modelInfo = {
      'production/maleAdult/diabetes_mellitus_type_2': {
        name: 'Diabetes Tipo 2',
        info: 'ü©∏ <strong>Diabetes Tipo 2:</strong> Condi√ß√£o cr√¥nica que afeta a forma como o corpo processa glicose. A resist√™ncia √† insulina e a diminui√ß√£o da produ√ß√£o pancre√°tica levam a n√≠veis elevados de a√ß√∫car no sangue. O controle glic√™mico, alimenta√ß√£o saud√°vel e atividade f√≠sica s√£o fundamentais para o tratamento.'
      },
      'production/maleAdult/pancreas': {
        name: 'P√¢ncreas',
        info: 'ü´Ä <strong>P√¢ncreas:</strong> √ìrg√£o vital que produz insulina e glucagon, horm√¥nios essenciais para regular o a√ß√∫car no sangue. Tamb√©m secreta enzimas digestivas importantes.'
      },
      'cardiovascular_system': {
        name: 'Sistema Cardiovascular',
        info: '‚ù§Ô∏è <strong>Sistema Cardiovascular:</strong> Rede complexa de cora√ß√£o, vasos sangu√≠neos e sangue que transporta oxig√™nio e nutrientes por todo o corpo. O cora√ß√£o bombeia cerca de 5 litros de sangue por minuto em repouso.'
      },
      'production/maleAdult/heart': {
        name: 'Cora√ß√£o',
        info: '‚ù§Ô∏è <strong>Cora√ß√£o:</strong> M√∫sculo que bombeia sangue continuamente. Dividido em quatro c√¢maras (dois √°trios e dois ventr√≠culos), trabalha incansavelmente batendo aproximadamente 100.000 vezes por dia.'
      },
      'production/maleAdult/hypertension': {
        name: 'Hipertens√£o',
        info: 'üìà <strong>Hipertens√£o:</strong> Press√£o arterial elevada que for√ßa o cora√ß√£o a trabalhar mais. Pode danificar art√©rias e aumentar risco de doen√ßas card√≠acas, AVC e problemas renais.'
      },
      'respiratory_system': {
        name: 'Sistema Respirat√≥rio',
        info: 'ü´Å <strong>Sistema Respirat√≥rio:</strong> Respons√°vel pela troca de gases, levando oxig√™nio aos tecidos e removendo di√≥xido de carbono. Inclui pulm√µes, br√¥nquios e vias a√©reas.'
      },
      'production/maleAdult/asthma': {
        name: 'Asma',
        info: 'üå¨Ô∏è <strong>Asma:</strong> Inflama√ß√£o cr√¥nica das vias a√©reas que causa estreitamento, produ√ß√£o de muco e dificuldade respirat√≥ria. Gatilhos incluem al√©rgenos, exerc√≠cio e irritantes.'
      },
      'digestive_system': {
        name: 'Sistema Digestivo',
        info: 'üç¥ <strong>Sistema Digestivo:</strong> Processa alimentos, extrai nutrientes e elimina res√≠duos. Inclui boca, es√¥fago, est√¥mago, intestinos, f√≠gado e p√¢ncreas.'
      },
      'production/maleAdult/liver': {
        name: 'F√≠gado',
        info: 'ü´Ä <strong>F√≠gado:</strong> Maior √≥rg√£o interno, realiza mais de 500 fun√ß√µes vitais incluindo desintoxica√ß√£o, produ√ß√£o de bile, armazenamento de nutrientes e metabolismo.'
      },
      'skeletal_system': {
        name: 'Sistema Esquel√©tico',
        info: 'ü¶¥ <strong>Sistema Esquel√©tico:</strong> 206 ossos que fornecem estrutura, protegem √≥rg√£os, produzem c√©lulas sangu√≠neas e armazenam minerais. Trabalha com m√∫sculos para permitir movimento.'
      },
      'production/maleAdult/osteoarthritis': {
        name: 'Osteoartrite',
        info: 'ü¶¥ <strong>Osteoartrite:</strong> Desgaste da cartilagem articular causando dor, rigidez e redu√ß√£o da mobilidade. Mais comum em joelhos, quadris, m√£os e coluna.'
      },
      'nervous_system': {
        name: 'Sistema Nervoso',
        info: 'üß† <strong>Sistema Nervoso:</strong> Rede de controle do corpo, processa informa√ß√µes sensoriais e coordena a√ß√µes volunt√°rias e involunt√°rias. Dividido em central (c√©rebro e medula) e perif√©rico.'
      },
      'production/maleAdult/brain': {
        name: 'C√©rebro',
        info: 'üß† <strong>C√©rebro:</strong> Centro de comando com aproximadamente 86 bilh√µes de neur√¥nios. Controla pensamento, mem√≥ria, emo√ß√µes, movimento e todas as fun√ß√µes corporais.'
      }
    };

    // Carregar modelo no iframe
    function loadModel(modelId, element) {
      currentModelId = modelId;
      currentModelElement = element;

      // Atualizar UI
      document.querySelectorAll('.model-card').forEach(card => card.classList.remove('active'));
      if (element) element.classList.add('active');

      // Mostrar loading
      const loading = document.getElementById('loadingOverlay');
      const iframe = document.getElementById('biodigital-iframe');
      loading.classList.remove('hidden');
      iframe.style.display = 'none';

      // Atualizar nome e info
      const modelData = modelInfo[modelId] || { name: 'Modelo 3D', info: 'Carregando informa√ß√µes...' };
      document.getElementById('currentModelName').textContent = modelData.name;
      document.getElementById('modelInfo').innerHTML = modelData.info;

      // Carregar iframe
      iframe.src = `https://human.biodigital.com/view?id=${modelId}&lang=pt`;

      // Esconder loading quando carregar
      iframe.onload = function() {
        setTimeout(() => {
          loading.classList.add('hidden');
          iframe.style.display = 'block';
          document.getElementById('viewerStatus').textContent = 'üü¢ Ativo';
        }, 500);
      };

      iframe.onerror = function() {
        loading.classList.add('hidden');
        document.getElementById('viewerStatus').textContent = 'üî¥ Erro';
        alert('Erro ao carregar modelo. Verifique sua conex√£o ou tente outro modelo.');
      };
    }

    // Recarregar modelo atual
    function reloadModel() {
      if (currentModelElement) {
        loadModel(currentModelId, currentModelElement);
      }
    }

    // Resetar c√¢mera (recarrega o iframe)
    function resetCamera() {
      reloadModel();
    }

    // Toggle fullscreen
    function toggleFullscreen() {
      const viewer = document.querySelector('.viewer-main');
      if (!document.fullscreenElement) {
        viewer.requestFullscreen().catch(err => {
          alert('Erro ao entrar em tela cheia: ' + err.message);
        });
      } else {
        document.exitFullscreen();
      }
    }

    // Toggle painel de informa√ß√µes
    function toggleInfo() {
      const panel = document.getElementById('infoPanel');
      panel.classList.toggle('hidden');
    }

    // Filtrar modelos por busca
    function filterModels() {
      const search = document.getElementById('searchInput').value.toLowerCase();
      const cards = document.querySelectorAll('.model-card');

      cards.forEach(card => {
        const keywords = card.getAttribute('data-keywords') || '';
        const text = card.textContent.toLowerCase();
        const matches = text.includes(search) || keywords.includes(search);
        card.style.display = matches ? 'block' : 'none';
      });

      // Esconder categorias vazias
      document.querySelectorAll('.category').forEach(category => {
        const visibleCards = category.querySelectorAll('.model-card[style*="display: block"], .model-card:not([style*="display: none"])');
        category.style.display = visibleCards.length > 0 ? 'block' : 'none';
      });
    }

    // Voltar para p√°gina anterior
    function goBack() {
      // Detectar de onde veio
      if (document.referrer && document.referrer.includes('waiting-room')) {
        window.location.href = 'waiting-room.html';
      } else if (document.referrer && document.referrer.includes('admin')) {
        window.location.href = 'admin/index.html';
      } else {
        // Criar landing page ou voltar para home
        window.location.href = 'index.html';
      }
    }

    // Inicializar no carregamento
    window.addEventListener('load', function() {
      // Carregar primeiro modelo
      const firstCard = document.querySelector('.model-card.active');
      if (firstCard) {
        loadModel(currentModelId, firstCard);
      }
    });
  </script>
</body>
</html>
