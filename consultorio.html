<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>BiOOH â€¢ ConsultÃ³rio 3D</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=DM+Serif+Display&display=swap" rel="stylesheet">
  <style>
    :root {
      --red:    #C8102E;
      --ink:    #0F172A;
      --sub:    #475569;
      --muted:  #94A3B8;
      --border: #E2E8F0;
      --bg:     #F8FAFC;
      --white:  #FFFFFF;
      --sidebar:280px;
      --header: 60px;
    }

    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html, body { height: 100%; overflow: hidden; }
    body {
      font-family: 'DM Sans', system-ui, sans-serif;
      background: var(--bg);
      color: var(--ink);
      display: flex;
      flex-direction: column;
    }

    /* â•â• HEADER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .header {
      height: var(--header);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 20px;
      background: var(--white);
      border-bottom: 1px solid var(--border);
      flex-shrink: 0;
      z-index: 100;
    }

    .header-left { display: flex; align-items: center; gap: 14px; }

    .back-btn {
      display: flex; align-items: center; gap: 6px;
      border: 1px solid var(--border); background: var(--white);
      padding: 7px 14px; border-radius: 8px;
      font: 600 13px 'DM Sans', sans-serif; color: var(--sub);
      cursor: pointer; transition: all .15s;
      text-decoration: none;
    }
    .back-btn:hover { background: var(--bg); border-color: #CBD5E1; color: var(--ink); }

    .brand { display: flex; align-items: center; gap: 9px; }
    .mark  { width: 30px; height: 30px; border-radius: 7px; background: var(--red); }
    .brandtxt { font-weight: 700; font-size: 16px; letter-spacing: -.3px; color: var(--ink); }

    .header-title {
      font-size: 14px; font-weight: 600; color: var(--sub);
      padding-left: 14px; border-left: 1px solid var(--border);
    }

    .header-right { display: flex; align-items: center; gap: 10px; }

    .btn-icon {
      width: 36px; height: 36px;
      display: flex; align-items: center; justify-content: center;
      border: 1px solid var(--border); border-radius: 8px;
      background: var(--white); cursor: pointer; font-size: 16px;
      transition: all .15s; color: var(--sub);
    }
    .btn-icon:hover { background: var(--bg); border-color: #CBD5E1; color: var(--ink); }

    /* â•â• LAYOUT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .layout {
      flex: 1;
      display: flex;
      overflow: hidden;
    }

    /* â•â• SIDEBAR â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .sidebar {
      width: var(--sidebar);
      flex-shrink: 0;
      background: var(--white);
      border-right: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .sidebar-top {
      padding: 14px 16px 10px;
      border-bottom: 1px solid var(--border);
    }

    .search-wrap {
      position: relative;
    }
    .search-icon {
      position: absolute; left: 10px; top: 50%; transform: translateY(-50%);
      font-size: 14px; color: var(--muted); pointer-events: none;
    }
    .search-input {
      width: 100%; padding: 8px 10px 8px 32px;
      border: 1px solid var(--border); border-radius: 8px;
      font: 400 13px 'DM Sans', sans-serif; color: var(--ink);
      background: var(--bg); outline: none; transition: border-color .15s;
    }
    .search-input:focus { border-color: #93C5FD; background: var(--white); }
    .search-input::placeholder { color: var(--muted); }

    .sidebar-list {
      flex: 1; overflow-y: auto; padding: 10px 12px;
    }
    .sidebar-list::-webkit-scrollbar { width: 4px; }
    .sidebar-list::-webkit-scrollbar-thumb { background: var(--border); border-radius: 4px; }

    .cat-label {
      font-size: 10px; font-weight: 700; letter-spacing: 1.1px;
      text-transform: uppercase; color: var(--muted);
      margin: 14px 4px 6px; display: block;
    }

    .model-btn {
      width: 100%; text-align: left;
      padding: 10px 12px;
      border: 1px solid transparent; border-radius: 10px;
      background: transparent; cursor: pointer;
      transition: all .15s; margin-bottom: 2px;
      display: flex; align-items: flex-start; gap: 10px;
    }
    .model-btn:hover { background: var(--bg); border-color: var(--border); }
    .model-btn.active {
      background: #FFF0F2; border-color: #FECDD3;
    }

    .model-emoji { font-size: 22px; line-height: 1; flex-shrink: 0; margin-top: 1px; }

    .model-info { flex: 1; min-width: 0; }
    .model-name {
      font-size: 13px; font-weight: 600; color: var(--ink);
      line-height: 1.3; margin-bottom: 2px;
      white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
    }
    .model-desc {
      font-size: 11.5px; color: var(--sub); line-height: 1.4;
    }

    .model-btn.active .model-name { color: var(--red); }

    /* â•â• MAIN: VIEWER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .main {
      flex: 1;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      position: relative;
    }

    /* info bar above viewer */
    .viewer-bar {
      padding: 12px 20px;
      background: var(--white);
      border-bottom: 1px solid var(--border);
      display: flex; align-items: center; justify-content: space-between;
      flex-shrink: 0;
    }

    .viewer-bar-left {}
    .viewer-title {
      font-family: 'DM Serif Display', Georgia, serif;
      font-size: 20px; font-weight: 400; color: var(--ink);
      margin-bottom: 2px;
    }
    .viewer-subtitle { font-size: 13px; color: var(--sub); }

    .viewer-actions { display: flex; gap: 8px; }

    .action-btn {
      display: flex; align-items: center; gap: 6px;
      padding: 7px 14px; border-radius: 8px;
      border: 1px solid var(--border); background: var(--white);
      font: 500 12px 'DM Sans', sans-serif; color: var(--sub);
      cursor: pointer; transition: all .15s;
    }
    .action-btn:hover { background: var(--bg); border-color: #CBD5E1; color: var(--ink); }
    .action-btn.primary {
      background: var(--red); border-color: var(--red); color: white;
    }
    .action-btn.primary:hover { background: #A50E26; }

    /* iframe container */
    .viewer-wrap {
      flex: 1; position: relative; background: #0F1923;
    }

    .viewer-frame {
      width: 100%; height: 100%;
      border: none; display: block;
    }

    /* loading overlay */
    .viewer-loading {
      position: absolute; inset: 0;
      background: #0F1923;
      display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      gap: 16px; z-index: 10;
    }
    .viewer-loading.hidden { display: none; }

    .loading-ring {
      width: 48px; height: 48px;
      border: 3px solid rgba(255,255,255,.1);
      border-top-color: white;
      border-radius: 50%;
      animation: spin .8s linear infinite;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    .loading-label {
      color: rgba(255,255,255,.6); font-size: 14px; font-weight: 500;
    }

    /* empty state */
    .viewer-empty {
      position: absolute; inset: 0;
      display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      gap: 12px; background: #0F1923;
    }
    .viewer-empty.hidden { display: none; }
    .empty-icon { font-size: 64px; opacity: .4; }
    .empty-text { color: rgba(255,255,255,.4); font-size: 15px; font-weight: 500; }

    /* â•â• INFO PANEL (bottom drawer) â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .info-panel {
      position: absolute; bottom: 0; left: 0; right: 0;
      background: var(--white);
      border-top: 1px solid var(--border);
      transform: translateY(100%);
      transition: transform .3s ease;
      z-index: 20;
      max-height: 55%;
      overflow-y: auto;
    }
    .info-panel.open { transform: translateY(0); }

    .info-panel-header {
      padding: 16px 20px 12px;
      display: flex; align-items: center; justify-content: space-between;
      border-bottom: 1px solid var(--border);
      position: sticky; top: 0; background: var(--white);
    }
    .info-panel-title {
      font-family: 'DM Serif Display', serif;
      font-size: 18px; color: var(--ink);
    }
    .close-btn {
      width: 30px; height: 30px;
      display: flex; align-items: center; justify-content: center;
      border: 1px solid var(--border); border-radius: 6px;
      background: none; cursor: pointer; font-size: 16px; color: var(--sub);
    }
    .close-btn:hover { background: var(--bg); }

    .info-body { padding: 16px 20px 24px; }

    .info-section { margin-bottom: 20px; }
    .info-section h4 {
      font-size: 10px; font-weight: 700; letter-spacing: 1.2px;
      text-transform: uppercase; color: var(--red); margin-bottom: 8px;
    }
    .info-section p {
      font-size: 14px; color: var(--sub); line-height: 1.7;
    }
    .info-section ul {
      list-style: none; padding: 0;
    }
    .info-section ul li {
      font-size: 14px; color: var(--sub); line-height: 1.6;
      padding: 4px 0 4px 18px; position: relative;
    }
    .info-section ul li::before {
      content: 'â€º'; position: absolute; left: 0;
      color: var(--red); font-size: 17px; line-height: 1.3; font-weight: 700;
    }

    /* tag chips */
    .tag-list { display: flex; flex-wrap: wrap; gap: 6px; margin-top: 8px; }
    .tag {
      padding: 3px 10px; border-radius: 999px;
      font-size: 11px; font-weight: 600;
      background: #FFF0F2; color: var(--red); border: 1px solid #FECDD3;
    }
  </style>
</head>
<body>

<!-- â”€â”€ HEADER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<header class="header">
  <div class="header-left">
    <a class="back-btn" href="index.html">â† Voltar</a>
    <div class="brand">
      <div class="mark"></div>
      <span class="brandtxt">BiOOH</span>
    </div>
    <span class="header-title">Visualizador 3D â€” ConsultÃ³rio</span>
  </div>
  <div class="header-right">
    <button class="btn-icon" title="Tela cheia" onclick="toggleFullscreen()">â›¶</button>
  </div>
</header>

<!-- â”€â”€ LAYOUT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div class="layout">

  <!-- SIDEBAR -->
  <aside class="sidebar">
    <div class="sidebar-top">
      <div class="search-wrap">
        <span class="search-icon">ğŸ”</span>
        <input id="searchInput" class="search-input" type="text"
               placeholder="Buscar modeloâ€¦" oninput="filterModels(this.value)">
      </div>
    </div>
    <div class="sidebar-list" id="modelList">
      <!-- populated by JS -->
    </div>
  </aside>

  <!-- MAIN -->
  <div class="main" id="main">

    <!-- bar above viewer -->
    <div class="viewer-bar" id="viewerBar">
      <div class="viewer-bar-left">
        <div class="viewer-title" id="viewerTitle">Selecione um modelo</div>
        <div class="viewer-subtitle" id="viewerSub">Escolha uma estrutura anatÃ´mica na lista Ã  esquerda</div>
      </div>
      <div class="viewer-actions">
        <button class="action-btn" onclick="reloadModel()" id="btnReload" style="display:none">â†º Recarregar</button>
        <button class="action-btn" onclick="toggleInfo()" id="btnInfo" style="display:none">â„¹ Info clÃ­nica</button>
      </div>
    </div>

    <!-- viewer -->
    <div class="viewer-wrap" id="viewerWrap">

      <div class="viewer-empty" id="viewerEmpty">
        <div class="empty-icon">ğŸ«€</div>
        <div class="empty-text">Selecione um modelo para visualizar</div>
      </div>

      <div class="viewer-loading hidden" id="viewerLoading">
        <div class="loading-ring"></div>
        <div class="loading-label" id="loadingLabel">Carregando modelo 3Dâ€¦</div>
      </div>

      <iframe id="viewerFrame" class="viewer-frame"
              style="display:none"
              allowfullscreen
              title="Visualizador 3D BioDigital Human"></iframe>
    </div>

    <!-- info panel -->
    <div class="info-panel" id="infoPanel">
      <div class="info-panel-header">
        <div class="info-panel-title" id="infoPanelTitle">â€”</div>
        <button class="close-btn" onclick="toggleInfo()">âœ•</button>
      </div>
      <div class="info-body" id="infoPanelBody"></div>
    </div>

  </div>
</div>

<script>
// â”€â”€â”€ DATA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// BioDigital embed format: https://human.biodigital.com/viewer/?id=XXXX&lang=pt
// IDs de modelos pÃºblicos/gratuitos
var MODELS = [
  // â”€â”€ CORAÃ‡ÃƒO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  {
    id: 'heart_chambers',
    biodigital: 'production/maleAdult/heart',
    emoji: 'â¤ï¸',
    name: 'CoraÃ§Ã£o â€” Anatomia Geral',
    desc: 'CÃ¢maras, vÃ¡lvulas e grandes vasos',
    cat: 'ğŸ«€ Cardiologia',
    tags: ['anatomia', 'cÃ¢maras', 'vÃ¡lvulas'],
    what: 'O coraÃ§Ã£o Ã© um Ã³rgÃ£o muscular do tamanho de um punho fechado, responsÃ¡vel por bombear o sangue por todo o corpo. Possui quatro cÃ¢maras: dois Ã¡trios e dois ventrÃ­culos, separados por vÃ¡lvulas que garantem o fluxo unidirecional do sangue.',
    clinical: [
      'Peso mÃ©dio: 300g em adultos',
      'FrequÃªncia em repouso: 60â€“100 bpm',
      'DÃ©bito cardÃ­aco: ~5 L/min em repouso',
      'Avaliado por ECG, ecocardiograma e cineangiocoronariografia'
    ],
    relevance: 'Base para compreender infartos, valvopatias e cardiomiopatias'
  },
  {
    id: 'coronary_arteries',
    biodigital: 'production/maleAdult/coronary_arteries',
    emoji: 'ğŸ©¸',
    name: 'ArtÃ©rias CoronÃ¡rias',
    desc: 'IrrigaÃ§Ã£o do mÃºsculo cardÃ­aco',
    cat: 'ğŸ«€ Cardiologia',
    tags: ['coronÃ¡rias', 'infarto', 'aterosclerose'],
    what: 'As artÃ©rias coronÃ¡rias sÃ£o os vasos que nutrem o prÃ³prio mÃºsculo cardÃ­aco. A coronÃ¡ria esquerda divide-se em descendente anterior e circunflexa; a direita irriga a parede posterior. O bloqueio dessas artÃ©rias causa infarto.',
    clinical: [
      'DA anterior: irriga 40â€“50% do miocÃ¡rdio',
      'ObstruÃ§Ã£o > 70% indica revascularizaÃ§Ã£o',
      'Avaliada por coronariografia ou angiotomografia',
      'Principal alvo da angioplastia e do stent'
    ],
    relevance: 'Essencial para explicar infarto, angina e revascularizaÃ§Ã£o miocÃ¡rdica'
  },
  {
    id: 'heart_failure',
    biodigital: 'production/maleAdult/heart_disease',
    emoji: 'ğŸ’”',
    name: 'InsuficiÃªncia CardÃ­aca',
    desc: 'CoraÃ§Ã£o com capacidade reduzida',
    cat: 'ğŸ«€ Cardiologia',
    tags: ['insuficiÃªncia', 'fraÃ§Ã£o ejeÃ§Ã£o', 'remodelamento'],
    what: 'Na insuficiÃªncia cardÃ­aca, o coraÃ§Ã£o nÃ£o consegue bombear sangue suficiente para as demandas do organismo. Pode ser sistÃ³lica (fraÃ§Ã£o de ejeÃ§Ã£o reduzida) ou diastÃ³lica (enchimento prejudicado).',
    clinical: [
      'FE normal: â‰¥ 55% â€” FE reduzida: < 40%',
      'Sintomas: dispneia, edema, ortopneia',
      'ClassificaÃ§Ã£o NYHA I a IV',
      'Tratamento: IECA/BRA, betabloqueadores, diurÃ©ticos'
    ],
    relevance: 'Explicar ao paciente a fisiopatologia e a importÃ¢ncia da adesÃ£o ao tratamento'
  },

  // â”€â”€ VASCULAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  {
    id: 'atherosclerosis',
    biodigital: 'production/maleAdult/atherosclerosis',
    emoji: 'ğŸ§±',
    name: 'Aterosclerose',
    desc: 'FormaÃ§Ã£o de placas nas artÃ©rias',
    cat: 'ğŸ©¸ Vascular',
    tags: ['placa', 'artÃ©ria', 'colesterol', 'LDL'],
    what: 'A aterosclerose Ã© o acÃºmulo progressivo de lipÃ­dios, cÃ©lulas inflamatÃ³rias e tecido fibroso na parede das artÃ©rias, formando placas que reduzem o lÃºmen vascular. A ruptura de uma placa instÃ¡vel pode causar infarto ou AVC.',
    clinical: [
      'Processo inicia-se ainda na infÃ¢ncia',
      'LDL elevado Ã© o principal fator modificÃ¡vel',
      'Meta de LDL em alto risco: < 50 mg/dL',
      'Visualizada por angiotomografia ou ultrassom vascular'
    ],
    relevance: 'Base de toda a doenÃ§a cardiovascular aterosclerÃ³tica â€” infarto, AVC, arteriopatia perifÃ©rica'
  },
  {
    id: 'hypertension_vessels',
    biodigital: 'production/maleAdult/cardiovascular_system',
    emoji: 'ğŸ“ˆ',
    name: 'HipertensÃ£o Arterial',
    desc: 'Impacto nos vasos e Ã³rgÃ£os-alvo',
    cat: 'ğŸ©¸ Vascular',
    tags: ['pressÃ£o', 'hipertensÃ£o', 'rim', 'coraÃ§Ã£o'],
    what: 'A hipertensÃ£o arterial sistÃªmica causa espessamento e rigidez das paredes arteriais, sobrecarregando o coraÃ§Ã£o, rins, cÃ©rebro e retina. Ã‰ o principal fator de risco modificÃ¡vel para AVC e insuficiÃªncia renal.',
    clinical: [
      'DiagnÃ³stico: PA â‰¥ 140/90 em duas aferiÃ§Ãµes',
      'HipertensÃ£o estÃ¡gio 3: â‰¥ 180/110',
      'LesÃµes de Ã³rgÃ£o-alvo: HVE, proteinÃºria, retinopatia',
      'Meta terapÃªutica geral: < 130/80 mmHg'
    ],
    relevance: 'Ajuda o paciente a entender por que controlar a pressÃ£o protege mÃºltiplos Ã³rgÃ£os'
  },

  // â”€â”€ CÃ‰REBRO / AVC â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  {
    id: 'brain_stroke',
    biodigital: 'production/maleAdult/brain',
    emoji: 'ğŸ§ ',
    name: 'CÃ©rebro e AVC',
    desc: 'TerritÃ³rios vasculares cerebrais',
    cat: 'ğŸ§  Neurologia',
    tags: ['AVC', 'derrame', 'artÃ©ria cerebral', 'isquemia'],
    what: 'O cÃ©rebro recebe sangue por quatro artÃ©rias principais. O AVC isquÃªmico ocorre quando uma delas Ã© bloqueada; o hemorrÃ¡gico, quando se rompe. Cada territÃ³rio irrigado corresponde a funÃ§Ãµes especÃ­ficas â€” o que explica os diferentes dÃ©ficits neurolÃ³gicos.',
    clinical: [
      'Janela para trombÃ³lise IV: atÃ© 4,5h do inÃ­cio',
      'Trombectomia mecÃ¢nica: atÃ© 24h em selecionados',
      'Escala NIHSS avalia gravidade clÃ­nica',
      'PrevenÃ§Ã£o secundÃ¡ria: antiagregantes ou anticoagulantes'
    ],
    relevance: 'Mostrar ao paciente os territÃ³rios e por que a rapidez no atendimento Ã© decisiva'
  },

  // â”€â”€ METABOLISMO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  {
    id: 'pancreas_diabetes',
    biodigital: 'production/maleAdult/endocrine_system',
    emoji: 'ğŸ¬',
    name: 'Diabetes e PÃ¢ncreas',
    desc: 'ProduÃ§Ã£o de insulina e glicemia',
    cat: 'âš—ï¸ Metabolismo',
    tags: ['diabetes', 'insulina', 'pÃ¢ncreas', 'glicemia'],
    what: 'As cÃ©lulas beta do pÃ¢ncreas produzem insulina, hormÃ´nio que permite a entrada de glicose nas cÃ©lulas. No DM tipo 1 hÃ¡ destruiÃ§Ã£o autoimune dessas cÃ©lulas; no DM tipo 2 hÃ¡ resistÃªncia perifÃ©rica e falÃªncia progressiva da secreÃ§Ã£o.',
    clinical: [
      'DiagnÃ³stico: glicemia jejum â‰¥ 126 ou HbA1c â‰¥ 6,5%',
      'Meta de HbA1c: < 7% (individualizar)',
      'DM tipo 2: metformina como primeira linha',
      'ComplicaÃ§Ãµes: nefropatia, retinopatia, neuropatia, cardiopatia'
    ],
    relevance: 'Explica ao paciente diabÃ©tico por que a glicemia elevada danifica vasos e nervos'
  },
  {
    id: 'obesity_metabolism',
    biodigital: 'production/maleAdult/adipose_tissue',
    emoji: 'âš–ï¸',
    name: 'Obesidade e Metabolismo',
    desc: 'Gordura visceral e sÃ­ndrome metabÃ³lica',
    cat: 'âš—ï¸ Metabolismo',
    tags: ['obesidade', 'gordura visceral', 'IMC', 'sÃ­ndrome metabÃ³lica'],
    what: 'A gordura visceral (abdominal) Ã© metabolicamente ativa â€” libera citocinas inflamatÃ³rias, Ã¡cidos graxos livres e hormÃ´nios que contribuem para resistÃªncia Ã  insulina, dislipidemia e hipertensÃ£o, compondo a sÃ­ndrome metabÃ³lica.',
    clinical: [
      'CircunferÃªncia abdominal de risco: > 94 cm (H), > 80 cm (M)',
      'IMC > 30 kg/mÂ² = obesidade grau I',
      'Perda de 5â€“10% reduz significativamente risco cardiovascular',
      'Tratamento: dieta, exercÃ­cio, medicamentos, cirurgia bariÃ¡trica'
    ],
    relevance: 'Motivar o paciente mostrando visualmente o impacto da gordura visceral'
  },

  // â”€â”€ RESPIRATÃ“RIO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  {
    id: 'lungs_anatomy',
    biodigital: 'production/maleAdult/respiratory_system',
    emoji: 'ğŸ«',
    name: 'PulmÃµes e Sistema RespiratÃ³rio',
    desc: 'Troca gasosa e oxigenaÃ§Ã£o do sangue',
    cat: 'ğŸ« RespiratÃ³rio',
    tags: ['pulmÃ£o', 'respiraÃ§Ã£o', 'oxigÃªnio', 'dispneia'],
    what: 'Os pulmÃµes sÃ£o responsÃ¡veis pela hematose â€” a troca de COâ‚‚ por Oâ‚‚ no sangue. Sua funÃ§Ã£o estÃ¡ intimamente ligada ao coraÃ§Ã£o: disfunÃ§Ã£o pulmonar sobrecarrega o ventrÃ­culo direito e vice-versa, explicando a dispneia na IC.',
    clinical: [
      'Capacidade vital mÃ©dia: 4,5â€“5 L',
      'SpOâ‚‚ normal: 95â€“100%',
      'Edema pulmonar: consequÃªncia da IC descompensada',
      'AvaliaÃ§Ã£o: espirometria, radiografia, TC de tÃ³rax'
    ],
    relevance: 'Fundamental para explicar dispneia, edema pulmonar e relaÃ§Ã£o coraÃ§Ã£o-pulmÃ£o'
  },

  // â”€â”€ MUSCULOESQUELÃ‰TICO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  {
    id: 'muscular_system',
    biodigital: 'production/maleAdult/muscular_system',
    emoji: 'ğŸ’ª',
    name: 'Sistema Muscular',
    desc: 'Massa magra e saÃºde cardiovascular',
    cat: 'ğŸ¦´ MusculoesquelÃ©tico',
    tags: ['mÃºsculo', 'sarcopenia', 'exercÃ­cio', 'forÃ§a'],
    what: 'A massa muscular esquelÃ©tica Ã© um Ã³rgÃ£o endÃ³crino: libera miocinas durante o exercÃ­cio que melhoram sensibilidade Ã  insulina, reduzem inflamaÃ§Ã£o e protegem o sistema cardiovascular. Sarcopenia estÃ¡ associada a maior mortalidade.',
    clinical: [
      'Sarcopenia: perda de massa + forÃ§a muscular',
      'ExercÃ­cio resistido 2x/semana Ã© recomendaÃ§Ã£o cardiolÃ³gica',
      'Cada kg de mÃºsculo consume mais glicose em repouso',
      'AvaliaÃ§Ã£o: dinamometria, DEXA, circunferÃªncia da panturrilha'
    ],
    relevance: 'Motivar paciente sedentÃ¡rio mostrando o papel do mÃºsculo na saÃºde cardÃ­aca'
  }
];

// â”€â”€â”€ STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
var current = null;
var infoPanelOpen = false;

// â”€â”€â”€ INIT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
(function init(){
  renderSidebar(MODELS);
})();

// â”€â”€â”€ SIDEBAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderSidebar(models){
  var list = document.getElementById('modelList');
  if(!list) return;

  // group by category
  var cats = {};
  models.forEach(function(m){
    if(!cats[m.cat]) cats[m.cat] = [];
    cats[m.cat].push(m);
  });

  var html = '';
  Object.keys(cats).forEach(function(cat){
    html += '<span class="cat-label">'+cat+'</span>';
    cats[cat].forEach(function(m){
      var active = current && current.id === m.id ? 'active' : '';
      html +=
        '<button class="model-btn '+active+'" onclick="selectModel(\''+m.id+'\')">'+
          '<span class="model-emoji">'+m.emoji+'</span>'+
          '<div class="model-info">'+
            '<div class="model-name">'+esc(m.name)+'</div>'+
            '<div class="model-desc">'+esc(m.desc)+'</div>'+
          '</div>'+
        '</button>';
    });
  });

  if(!html) html = '<div style="padding:24px;text-align:center;color:var(--muted);font-size:13px">Nenhum modelo encontrado</div>';
  list.innerHTML = html;
}

function filterModels(q){
  q = q.toLowerCase().trim();
  if(!q){ renderSidebar(MODELS); return; }
  var filtered = MODELS.filter(function(m){
    return m.name.toLowerCase().includes(q)
        || m.desc.toLowerCase().includes(q)
        || m.tags.some(function(t){ return t.includes(q); })
        || m.cat.toLowerCase().includes(q);
  });
  renderSidebar(filtered);
}

// â”€â”€â”€ SELECT / LOAD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function selectModel(id){
  var model = MODELS.find(function(m){ return m.id === id; });
  if(!model) return;

  current = model;
  renderSidebar(MODELS); // re-render to update active state

  // update bar
  document.getElementById('viewerTitle').textContent = model.emoji + ' ' + model.name;
  document.getElementById('viewerSub').textContent = model.desc;
  document.getElementById('btnReload').style.display = '';
  document.getElementById('btnInfo').style.display = '';

  // close info panel if open
  if(infoPanelOpen) closeInfo();

  // show loader, hide frame and empty
  document.getElementById('viewerEmpty').classList.add('hidden');
  document.getElementById('viewerLoading').classList.remove('hidden');
  document.getElementById('loadingLabel').textContent = 'Carregando ' + model.name + 'â€¦';
  document.getElementById('viewerFrame').style.display = 'none';

  // build BioDigital URL
  var url = 'https://human.biodigital.com/viewer/?id='
    + encodeURIComponent(model.biodigital)
    + '&lang=pt&ui-anatomy-descriptions=true&ui-panel=false';

  var frame = document.getElementById('viewerFrame');
  frame.onload = function(){
    document.getElementById('viewerLoading').classList.add('hidden');
    frame.style.display = 'block';
  };
  frame.onerror = function(){
    document.getElementById('viewerLoading').classList.add('hidden');
    showFallback(model);
  };
  frame.src = url;

  // fallback timeout (BioDigital sometimes doesn't fire onload)
  setTimeout(function(){
    if(document.getElementById('viewerLoading') &&
       !document.getElementById('viewerLoading').classList.contains('hidden')){
      document.getElementById('viewerLoading').classList.add('hidden');
      if(frame.style.display === 'none') showFallback(model);
    }
  }, 8000);
}

function showFallback(model){
  var wrap = document.getElementById('viewerWrap');
  // inject a nice fallback card
  var fb = document.createElement('div');
  fb.style.cssText = 'position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:12px;background:#0F1923;color:white;text-align:center;padding:40px';
  fb.innerHTML =
    '<div style="font-size:72px">'+model.emoji+'</div>'+
    '<div style="font-size:20px;font-weight:700;margin-bottom:4px">'+esc(model.name)+'</div>'+
    '<div style="font-size:14px;opacity:.6;max-width:400px;line-height:1.6">'+esc(model.what||model.desc)+'</div>'+
    '<div style="margin-top:16px;opacity:.4;font-size:12px">Visualizador 3D indisponÃ­vel â€” verifique conexÃ£o ou acesse human.biodigital.com</div>';
  wrap.appendChild(fb);
}

function reloadModel(){
  if(current) selectModel(current.id);
}

// â”€â”€â”€ INFO PANEL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function toggleInfo(){
  if(infoPanelOpen) closeInfo();
  else openInfo();
}

function openInfo(){
  if(!current) return;
  var panel = document.getElementById('infoPanel');
  document.getElementById('infoPanelTitle').textContent = current.emoji + ' ' + current.name;

  var tags = (current.tags||[]).map(function(t){
    return '<span class="tag">'+esc(t)+'</span>';
  }).join('');

  var clinical = (current.clinical||[]).map(function(c){
    return '<li>'+esc(c)+'</li>';
  }).join('');

  document.getElementById('infoPanelBody').innerHTML =
    '<div class="info-section">'+
      '<h4>O que Ã©</h4>'+
      '<p>'+esc(current.what||'')+'</p>'+
    '</div>'+
    (clinical ? '<div class="info-section"><h4>Dados clÃ­nicos</h4><ul>'+clinical+'</ul></div>' : '')+
    '<div class="info-section">'+
      '<h4>RelevÃ¢ncia clÃ­nica</h4>'+
      '<p>'+esc(current.relevance||'')+'</p>'+
    '</div>'+
    (tags ? '<div class="info-section"><h4>Termos relacionados</h4><div class="tag-list">'+tags+'</div></div>' : '');

  panel.classList.add('open');
  infoPanelOpen = true;
  document.getElementById('btnInfo').textContent = 'âœ• Fechar info';
}

function closeInfo(){
  document.getElementById('infoPanel').classList.remove('open');
  infoPanelOpen = false;
  document.getElementById('btnInfo').textContent = 'â„¹ Info clÃ­nica';
}

// â”€â”€â”€ FULLSCREEN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function toggleFullscreen(){
  var el = document.getElementById('viewerWrap');
  if(!document.fullscreenElement){
    (el.requestFullscreen||el.webkitRequestFullscreen).call(el);
  } else {
    (document.exitFullscreen||document.webkitExitFullscreen).call(document);
  }
}

// â”€â”€â”€ UTILS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function esc(s){
  return String(s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
}
</script>
</body>
</html>

